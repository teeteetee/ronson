doctype html(lang='en')
head
    meta(charset='utf-8')
    |     
    meta(http-equiv='X-UA-Compatible', content='IE=edge')
    |     
    meta(name='viewport', content='width=device-width, initial-scale=1')
    |     
    title Recent ones
    // Bootstrap
    link(href='/bootstrap/css/bootstrap.min.css', rel='stylesheet')
    // HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries
    // WARNING: Respond.js doesn't work if you view the page via file://
    //if lt IE 9
      script(src='https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js')
      |       
      script(src='https://oss.maxcdn.com/respond/1.4.2/respond.min.js')     
    style.
      @font-face {
      font-family:roboto-thin;
      src:url('/bootstrap/fonts/Roboto-Thin.ttf');
      }
      @font-face {
      font-family:high;
      src: url('/bootstrap/fonts/Attentica.ttf');
      }
      @font-face {
      font-family:br;
      src: url('/bootstrap/fonts/bebasneue_regular.ttf');
      }
      @font-face {
      font-family:bt;
      src: url('/bootstrap/fonts/bebasneue_thin.ttf');
      }
      h1 {
      font-size:1vw;
      font-family:arial;
      letter-spacing:0.3vw;
      text-transform:uppercase;
      color:gray;
      }
      body {
      min-width:768px;
      background-color:#fff;
      background-image:url('/bootstrap/images/stripe4.png');
      }
      h2 {
      font-size:6vw;
      font-family:br;
      letter-spacing:7px;
      }
      h3 {
      font-family:roboto-thin;
      font-size:3vw;
      }
      h4 {
      font-size:2vw;
      font-family:roboto-thin;
      letter-spacing:0.3vw;
      text-transform:uppercase;
      }
      h5 {
      font-family:helvetica,sans;
      font-size:2vw;
      }
      img {
      width:100%;
      }
      .underline:hover {
        border-bottom:3px solid gray;
      }
      a {
        font-family:br;
        font-size:3vw;
        color:#fc654a;
      }
      a:hover {
        text-decoration:none;
        outline:none;
      }
  body
    .container(style='background-color:#eee;min-height:100vh;')
      #header.row
        .col-xs-1(style='padding-top:15px;padding-bottom:15px;')
          a(class="navbar-brand" style='padding:5px;' href="/")
            img(alt="Logo",src="/bootstrap/images/rl.png",height='40',width='40') 
        .col-xs-10
          h1 Подверждение времени съемки      
      #text.row(style='padding-bottom: 2vh; padding-top: 2vh; text-align: center;')
        .col-xs-12
          h3 #{doc.nameru}
      #formrow.row
        .col-xs-10.col-xs-offset-1
          form(action='/conf/#{doc.clid}',class='form-horizontal',method='post',role='form')
            .form-group
              .input-group.input-group-lg
                span(class="input-group-addon",id="sizing-addon1") Дата 
                input(type="text",class="form-control",aria-describedby="sizing-addon1",id='sdate',placeholder='11 июля')
            .form-group
              .input-group.input-group-lg
                span(class="input-group-addon" id="sizing-addon1") Время
                input(type="text",class="form-control",aria-describedby="sizing-addon1",id='stime',placeholder='13.30-14.20')
            .form-group
              .input-group.input-group-lg
                span(class="input-group-addon" id="sizing-addon1") Контактное лицо
                input(type="text",class="form-control",aria-describedby="sizing-addon1",id='contact',placeholder='Иванов Федор +79647777777') 
            .form-group
              textarea(class='form-control',rows='3',id='comments',placeholder='Комментарии')
            .form-group(style='text-align:center;')   
              button(class='btn btn-primary btn-lg',id='sss',type='button',style='margin-top:2vh;') Подтверждаю  
      script(src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js') 
      script.                  
        $('#sss').click(function() {
        var sdate = $('#sdate').val();
        var stime = $('#stime').val();
        var contact = $('#contact').val();
        var comments = $('#comments').val();
        request = new XMLHttpRequest();
        request.onreadystatechange = function () {
        var DONE = this.DONE || 4;
        if (this.readyState === DONE){
        var parsed = JSON.parse(request.responseText);
        alert(parsed.trouble);
        if (parsed.trouble === 1)
        {alert('ERROR');}
        else {
         $('#formrow').empty();
         $('#formrow').append("<div class='col-xs-12' style='text-align:center;'><h2>Спасибо</h2></div>");
        }}
        };
        request.open('POST','/conf/#{doc.clid}', true);
        request.setRequestHeader('X-Requested-With', 'XMLHttpRequest');  // Tells server that this call is made for ajax purposes.
        request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        // THAT NEEDS TO BE CORRECTED. IT SUPPOSED TO CHECK FOR ALL THE OFFERS BUT SERVER SIDE DOESNT SUPPORT IT YET. AT LEAST CHANGE TO 'CALENDAR'
        alert("cdate="+sdate+"&ctime="+stime+"&contact="+contact+"&comments="+comments);
        request.send("cdate="+sdate+"&ctime="+stime+"&contact="+contact+"&comments="+comments);  
        });
          
          

        