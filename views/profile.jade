doctype html
html(lang='en')
  head
    meta(charset='utf-8')
    meta(http-equiv='X-UA-Compatible', content='IE=edge')
    meta(name='viewport', content='width=device-width, initial-scale=1')
    // The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags
    title INTP Love
    // Bootstrap
    link(href='http://fonts.googleapis.com/css?family=Josefin+Sans&subset=latin,latin-ext', rel='stylesheet', type='text/css')
    link(href='/bootstrap/css/bootstrap.min.css', rel='stylesheet')
    link(href='//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css', rel='stylesheet')
    meta(liber de amicitia est)
    meta(property="og:url"           content="http://intplove.com")
    meta(property="og:type"          content="website")
    meta(property="og:title"         content="INTP INTJ LOVE")
    meta(property="og:description"   content="Place to find your INTP or INTJ half")
    meta(property="og:image"         content="http://intplove.com/images/intplove_logo.png")
    // HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries
    // WARNING: Respond.js doesn't work if you view the page via file://
    //if lt IE 9
    script(src='https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js')
    script(src='https://oss.maxcdn.com/respond/1.4.2/respond.min.js')
    script(src='/js/share.js')
    style.
      body{
      background-color:#333;
      padding-bottom:30px;
      }
      .header {
      text-align:center;
      }
      .header h1 {
      margin-top:50px;
      text-transform: uppercase;
      }
      .header h4 {
      margin-top:20px;
      margin-bottom:30px;
      text-transform: uppercase;
      font-weight: 200;
      color: #bbb;
      }
      .footer {
      text-align:center;
      bottom: 0;
      width: 100%;
      }
      .participate {
      text-align:center;
      margin-top:50px;
      margin-bottom:70px;
      }
      .language {
      position:absolute;
      top:20px;
      right:20px;
      }
      #apply {
      display:none;
      }
      #ru_cont {
      display:none;
      }
      .user {
      border-bottom:1px solid #eee;
      padding-top:20px;
      padding-bottom:15px;
      padding-left:10px;
      }
      .user h5 {
      margin-top:0px;
      }
      .user:last-child {
      border-bottom:none;
      }
      .emptyavatar {
      /*margin:30px;
      margin-left:50px;
      margin-right:50px;*/
      margin:auto;
      width:90px;
      height:90px;
      background-color:#eee;
      border-radius:50%;
      }
      #main {
      background-color:white;
      border-radius:6px;
      }
      #mainholder {
      border-radius:6px;
      }
      #head {
      border: 1px solid #232323;
      padding-bottom:30px;
      text-align:center;
      border-top-left-radius:6px;
      border-top-right-radius:6px;
      background-color:#222;
      }
      h1{
      font-family:Josefin Sans;
      text-align:center;
      margin-bottom:80px;
      letter-spacing: 12px;
      color: #222;
      font-size:80px; 
      }
      #avatars {
      text-align:center;
      padding-top:30px;
      padding-bottom:30px;
      border-bottom:1px solid #ddd;
      background-color:#232323;
      }
      #eng_cont {
      padding-top:45px;
      }
      @media (max-width: 767px) {
      #eng_cont {
      padding-top:0px;
      }
      #avatars {
        background-color:#333;
      }
        h1 {
          font-size:36px;
          margin-bottom:20px
        }
      .user {
        padding-left:20px;
      }
      #head {
      border: 1px solid #232323;
      border-top-left-radius:0px;
      border-top-right-radius:0px;
      }
      #mainholder{
        border-radius:0px;
      }
      #main {
        border-radius:0px;
      }
      }
      h6 {
      color:#ddd;
      }
      #head .btn-default,#head .btn-default:hover,#head .btn-default:focus {
      border-color:teal;
      background-color:#333;
      color:teal;
      }
      #head .btn-default.active,#head .btn-default.active:active {
      border-color:teal;
      background-color:teal;
      color:#333;
      }
      .pagination>.active>a, .pagination>.active>a:focus, .pagination>.active>a:hover, .pagination>.active>span, .pagination>.active>span:focus, .pagination>.active>span:hover {
      background-color:teal;
      border-color:teal;
      color:#333;
      }
      .pagination>li>a, .pagination>li>span {
      background-color:#333;
      border-color:teal;
      color:teal;
      }
      .btn-send {
      margin-top:20px;
      margin-bottom:5px;
      }
      .user .col-xs-9 {
      padding-left:10px;
      }
      .modal input {
      max-width:400px;
      }
      .user .col-xs-3 {
      text-align:center;
      }
      .glyphicon-map-marker {
        margin-right:5px
      }
      .loader {
      margin: 60px auto;
      margin-top:20%;
      font-size: 10px;
      position: relative;
      text-indent: -9999em;
      border-top: 1.1em solid rgba(255, 255, 255, 0.2);
      border-right: 1.1em solid rgba(255, 255, 255, 0.2);
      border-bottom: 1.1em solid rgba(255, 255, 255, 0.2);
      border-left: 1.1em solid #ffffff;
      -webkit-transform: translateZ(0);
      -ms-transform: translateZ(0);
      transform: translateZ(0);
      -webkit-animation: load8 1.1s infinite linear;
      animation: load8 1.1s infinite linear;
      }
      .loader,
      .loader:after {
        border-radius: 50%;
        width: 10em;
        height: 10em;
      }
      @-webkit-keyframes load8 {
        0% {
          -webkit-transform: rotate(0deg);
          transform: rotate(0deg);
        }
        100% {
          -webkit-transform: rotate(360deg);
          transform: rotate(360deg);
        }
      }
      @keyframes load8 {
        0% {
          -webkit-transform: rotate(0deg);
          transform: rotate(0deg);
        }
        100% {
          -webkit-transform: rotate(360deg);
          transform: rotate(360deg);
        }
      }
      .socialbtns .fa {
        width: 35px;
        height: 35px;
        margin-left:5px;
        margin-right:5px;
        /*background-color: #FFF;*/
        color:#333;
        border-color:#333;
        padding-top: 11px;
        border-radius: 22px;
        -moz-border-radius: 22px;
        -webkit-border-radius: 22px;
        -o-border-radius: 22px;
        border:1px solid #ff9900;
        transition: border-color 0.5s ease;
        margin-bottom: 5px;
      }
      .socialbtns .fa:hover {
        border:1px solid #333;
      }
      .regerr {
        margin-top:30px;
        margin-bottom:30px;
        text-align:center;
        display:none;
      }
      #resendveri {
        margin-top:30px;
        margin-bottom:30px;
        text-align:center;
        display:none;
      }
      a:focus, a:hover, a:active {
        color:#446179 !importnat;
        text-decoration:none !important;
      }
      #profile {
        margin-top:30px;
        border-bottom: 1px solid #323232;
        border-top: 1px solid #323232;
        text-align:center;
        transition:background-color 0.5s linear;
      }
      #profile a {
        color:#515558;
      }
      #profile .col-xs-3.active {
        background-color: #292929;
      }
      #profile .col-xs-3.active a {
      color:#3A6890;
      }
      #profile .col-xs-3:hover {
        background-color: #292929;
      }
      #profile .col-xs-3 {
        border-right:1px solid #333;
        text-align:center;
        padding:10px;
      }
      #profile .col-xs-3:last-child {
        border-right:none;
      }
      .form-control {
      border: 1px solid #555758;
      background-color: #424242 !important;
      color:white;
      }
      #emptyavatar {
      margin:30px;
      margin-left:50px;
      margin-right:50px;
      width:150px;
      height:150px;
      border:7px dotted #404040;
      border-radius:50%;
      display:none;
      transition: border-color 0.5s ease;
      }
      #emptyavatar:hover {
        border-color:#ddd;
      }
      .badge {
      margin-left:5px;
      color:#ff9900;
      background-color: rgba(213, 136, 20, 0.3);
      border-radius: 4px;
      }
      #bottomNav {
        font-size:20px;
      }
      #bottomNav .active {
        background-color:#333;
        height:60px;
      }
      #bottomNav .glyphicon{
        top:0px;
        line-height:3;
      }
      #bottomNav .col-xs-3 {
        border-right:1px solid #333;
      }
      #bottomNav .col-xs-3:last-child {
        border-right:none;
      }
  body
    #register.modal.fade(tabindex='-1', role='dialog', aria-labelledby='myModalLabel')
      .modal-dialog(role='document')
        .modal-content
          .modal-header
            button.close(type='button', data-dismiss='modal', aria-label='Close')
              span(aria-hidden='true')  ×
            h4.modal-title(style='color:#ddd;')  Регистрация 
          .modal-body
          .row.regerr
            .col-xs-12
              h3#regerrtext
          .row
            .col-xs-12
              form
                .form-group
                  label(for='email')  email
                  input#email.form-control(type='email', autocomplete='off', placeholder='Neuroscience')
                .form-group
                  label(for='pagetitle')  Имя
                  input#uname.form-control(type='text', autocomplete='off', placeholder='Neuroscience')
                .form-group
                  label(for='pagetitle')  Пароль
                  input#pas.form-control(type='password', autocomplete='off', placeholder='Neuroscience')
                .form-group
                  label(for='pagetitle')  Город
                  input#city.form-control(type='text', autocomplete='off', placeholder='Neuroscience')
                .form-group
                  label(for='pagetitle')  Возраст
                  input#age.form-control(type='text', autocomplete='off', placeholder='Neuroscience')
                .form-group
                  label(for='pagetitle')  О себе
                  textarea#about_fill.form-control(autocomplete='off', placeholder='Neuroscience')
                .btn-group 
                  button(type='button' class='btn btn-default active' id='female') Female
                  button(type='button' class='btn btn-default' id='male') Male
          .modal-footer
            button.btn.btn-primary#regbutton  Сохранить
    .container(id='wait' style='background-color:rgba(0, 0, 0, 0.63);position:fixed;width:100%;height:100%;z-index:9999;display:none;')
        .row(id='spin') 
          .col-xs-12(style='text-align:center;')
            .loader
    #eng_cont.container
      .row
        .col-xs-12
          h1 INTPLOVE
      #mainholder.row
        #main.col-xs-12.col-sm-8.col-sm-offset-2.col-md-6.col-md-offset-3.col-lg-6.col-lg-offset-3
          #head.row.hidden-xs
            .col-xs-12
              #profile.row
                .col-xs-3(onclick="location='/';")
                  a(href='/')
                    span(class='glyphicon glyphicon-search' style='margin-right:5px;') 
                    | Поиск
                .col-xs-3.active
                  a(href='/#')
                    span(class='glyphicon glyphicon-user' style='margin-right:5px;') 
                    | Профиль
                .col-xs-3(onclick="location='/messages';")
                  a#messages(href='/messages') 
                    span(class='glyphicon glyphicon-envelope' style='margin-right:5px;') 
                    | Почта
                .col-xs-3(onclick="location='/logout';")
                  a(href='/logout') 
                    span(class='glyphicon glyphicon-log-out' style='margin-right:5px;') 
                    | Выйти  
          .row#avatars
            .col-xs-12
              form(id='userpic_form' action="/usrp" method="post" enctype="multipart/form-data" style='height:0px;width:0px;')
                input(type="file" id='userpic' name="userpic" style='height:0px;width:0px;')
              #emptyavatar(style='margin:auto !important;' class='img-circle')
                h4(style='color:#ff9900;margin-top:40px;') Upload an image
                span(class='glyphicon glyphicon-save' style='color:#ff9900;')
              img(id='avatar' class='img-circle' style='margin:auto !important;height:200px;width:200px;box-shadow: 1px 5px 10px 1px #0e0e0e;display:none;') 
              h3#name(style='color:#ddd;margin-top:40px;')
              h5#location(style='color:#4c4c4c;')
          .row(style='padding-top:20px;padding-bottom:20px;border-bottom:1px solid #ddd;')
            .col-xs-12
              p#about
          .row(style='text-align:center;padding-top:30px;padding-bottom:60px;')
            .col-xs-12
              a(class='btn btn-primary') Редактировать
    #ru_cont.container(style='display:none;')
    footer.footer.hidden-xs
      .container
        .row
          .col-xs-12
            h6(style='font-weight:200;margin-top:40px;color:#636363;') INTPLOVE 2015
            a(style='margin-bottom:30px;font-weight:200;', href='mailto:feedback@intplove.ru') Contact us
    footer.visible-xs(style='height:60px;width:100%;position:fixed;bottom:0px;background-color:#232323;')
      .col-xs-12.navbar-inverse.navbar-fixed-bottom
      .row#bottomNav
        .col-xs-3.text-center(onclick="location='/';")
          a(href="/") 
            i(class="glyphicon glyphicon-search")
              //  
                br 
                | Поиск
        .col-xs-3.text-center.active
          a(href="#") 
            i(class="glyphicon glyphicon-user")
              //  
                br 
                | Профиль
        .col-xs-3.text-center(onclick="location='/messages';")
          a(href="/messages") 
            i(id='envelope' class="glyphicon glyphicon-envelope")
              //  
                br 
                | Почта
        .col-xs-3.text-center(onclick="location='/logout';")
          a(href="/logout") 
            i(class="glyphicon glyphicon-log-out")
              //  
                br 
                | Выход
    // jQuery (necessary for Bootstrap's JavaScript plugins)
    script(src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js')
    // Include all compiled plugins (below), or include individual files as needed
    //script(src='/js/jquery.min.js')
    script(src='/js/bootstrap.min.js')
    //script(src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD8lRm1SQ5qlhTnvAAwX5Y8mO-P9qq8HfQ&signed_in=true&libraries=places&callback=initialize" async defer)
    script.
      var user = !{JSON.stringify(user)};
      user= JSON.parse(user);
      if(user && user.userpic) {
      $('#avatar').attr('src','/userpics/'+user._id+'.png');
      $('#avatar').css('display','block');
      $('#name').text(user.name);
      $('#location').append("<span class='glyphicon glyphicon-map-marker'></span>"+user.city);
      $('#about').text(user.about);
      }
      if (user && !user.userpic) {
       $('#emptyavatar').css('display','block');
       $('#name').text(user.name);
       $('#location').append("<span class='glyphicon glyphicon-map-marker'></span>"+user.city);
       $('#about').text(user.about);
      }
      //  //sonorous-shore-113306
      //  function initialize() {
      //   var options = {
      //    types: ['(cities)'],
      //    componentRestrictions: {}
      //   };
      //   var input = document.getElementById('location');
      //   var autocomplete = new google.maps.places.Autocomplete(input, options);
      //   google.maps.event.addListener(autocomplete, 'place_changed', function(){
      //     //# $('.your-input').val() to get the value from your input
      //     var place = autocomplete.getPlace();
      //     console.log(place.place_id);
      //     
      //   });
      //  }
      $('#emptyavatar').click(function(){
          $('#userpic').click();
          //return false;
      });
      $("#userpic").change(function() {
      $("#userpic_form").submit();
      });
      $.ajax({
              method: "POST",
              url: "/ntfc_m",
              data: 0
            }).done(function( msg ) {
                if(msg.newmsg){
                  console.log(msg.newmsg);
                 $('#messages').append('<span class="badge">+'+msg.newmsg+'</span>');
                 $('#envelope').css('color','#ff9900');
                }
               });
        
          

