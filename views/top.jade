doctype html(lang='en')
head
    meta(charset='utf-8')
    |     
    meta(http-equiv='X-UA-Compatible', content='IE=edge')
    |     
    meta(name='viewport', content='width=device-width, initial-scale=1')
    |     
    title Recent ones
    // Bootstrap
    link(href='/bootstrap/css/bootstrap.min.css', rel='stylesheet')
    // HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries
    // WARNING: Respond.js doesn't work if you view the page via file://
    //if lt IE 9
      script(src='https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js')
      |       
      script(src='https://oss.maxcdn.com/respond/1.4.2/respond.min.js')     
    style.
      @font-face {
      font-family:roboto-thin;
      src:url('/bootstrap/fonts/Roboto-Thin.ttf');
      }
      @font-face {
      font-family:high;
      src: url('/bootstrap/fonts/Attentica.ttf');
      }
      @font-face {
      font-family:br;
      src: url('/bootstrap/fonts/bebasneue_regular.ttf');
      }
      @font-face {
      font-family:bt;
      src: url('/bootstrap/fonts/bebasneue_thin.ttf');
      }
      h1 {
      font-family:high;
      letter-spacing:7px;
      }
      body {
      min-width:768px;
      background-color:#eee;
      }
      h2 {
      font-size:6vw;
      font-family:br;
      letter-spacing:7px;
      }
      h3 {
      font-size:3vw;
      }
      h4 {
      font-size:1vw;
      font-family:roboto-thin;
      letter-spacing:0.3vw;
      text-transform:uppercase;
      color:black;
      }
      h5 {
      letter-spacing:2px;
      text-transform:uppercase;
      font-family:roboto-thin;
      font-size:2vw;
      margin:0px;
      padding-top:1vh;
      padding-bottom:1vh;
      }
      .list-group-item.active, .list-group-item.active:focus, .list-group-item.active:hover {
      color: white;
      background-color: lightcoral;
      border-color: lightgray;
      }  
  body
    nav(class="navbar navbar-inverse navbar-fixed-top")
      .container
        .navbar-header
          a(class="navbar-brand" style='padding:5px;' href="/")
            img(alt="Logo",id='logo',src="/bootstrap/images/rl.png",height='40',width='40')
        .collapse.navbar-collapse#navbar-collapse-9
          ul(class='nav navbar-nav')
            li
              a(href='/',style='font-family:high;font-size:20px;letter-spacing:2px;') Лента 
            li(class='active')
              a(href='#',style='font-family:high;font-size:20px;letter-spacing:2px;') Рейтинги 
            li
              a(href='/search',style='font-family:high;font-size:20px;letter-spacing:2px;') Поиск
            li
              a(href='/misc/1',style='font-family:high;font-size:20px;letter-spacing:2px;') Инфо 
    .container(style='margin-top:50px;')
      .row
        .col-xs-12
          .alert.alert-info(role="alert")
            strong
              span(class='glyphicon glyphicon-time')
            | Мы еще не успели отснять все заведения в списках, но через месяц все будет готово.
      .row
        #inserts.col-xs-12(style='text-align:center;padding-bottom:20px;')
      script(src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js')
      script.
        var toplist = !{doc};
        console.log("first time: "+toplist);
        //toplist = JSON.parse(toplist);
        //console.log("second time: "+toplist);
        var left = toplist.length%3;
        console.log('left: '+left);
        var times = (toplist.length-left)/3;
        console.log('times :'+times);
        if(toplist.length<3){
          $('#inserts').append("<div class='row' id='row1' style='padding-top:2vw;'></div>");
          for (var i=0;i<toplist.length;i++){
            var cellnum = i+1;
            var insert = "<div class='col-xs-4'><div class='list-group' id='ratcell"+cellnum+"'><a href='#' style='cursor:default' class='list-group-item active'>"+toplist[i].ratingname+"</a></div></div>";
            $('#row1').append(insert);
            for (var yy=1;yy<11;yy++){  
            var point = "<a href='http://recentones.com/places/"+toplist[i].pids[yy]+"' class='list-group-item'>"+toplist[i].places[yy]+"</a>";
              eval("$('#ratcell"+cellnum+"').append(point)");
          }
          }
        }
        else{
        for (var xx=0;xx<times;xx++)
        { 
          var rnum = xx+1;
          $('#inserts').append("<div class='row' id='row"+rnum+"' style='padding-top:2vw;'></div>");
          for (var i=0;i<3;i++){
            var cellnum = xx*3+i+1;
            var hnum = cellnum-1;
            var insert = "<div class='col-xs-4'><div class='list-group' id='ratcell"+cellnum+"'><a href='#' style='cursor:default' class='list-group-item active'>"+toplist[hnum].ratingname+"</a></div></div>";
            eval("$('#row"+rnum+"').append(insert);");
            for (var yy=1;yy<11;yy++){
             var point = "<a href='http://recentones.com/places/"+toplist[i].pids[yy]+"' class='list-group-item'>"+toplist[i].places[yy]+"</a>";
              eval("$('#ratcell"+cellnum+"').append(point)");
          }
          }
          console.log('rnum: '+rnum);
          console.log('times: '+times);
          if(rnum===times && left != 3 && left != 0){
          console.log('populating last');
          for (var yy=0;yy<left;yy++){
           var cellnum = rnum*3+yy+1;
           var hnum = cellnum-1;
            nrnum=rnum+1;
            $('#inserts').append("<div class='row' id='row"+nrnum+"' style='padding-top:2vw;'></div>");
            var insert = "<div class='col-xs-4'><div class='list-group' id='ratcell"+cellnum+"'><a href='#' style='cursor:default' class='list-group-item active'>"+toplist[hnum].ratingname+"</a></div></div>";
            eval("$('#row"+nrnum+"').append(insert);");
            for (var zz=1;zz<11;zz++){
            var point = "<a href='http://recentones.com/places/"+toplist[i].pids[zz]+"' class='list-group-item'>"+toplist[i].places[zz]+"</a>";
              eval("$('#ratcell"+cellnum+"').append(point)");
          }
          }
        }
         }   
         }   
