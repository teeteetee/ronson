doctype html(lang='en')
head
    meta(charset='utf-8')
    |     
    meta(http-equiv='X-UA-Compatible', content='IE=edge')
    |     
    meta(name='viewport', content='width=device-width, initial-scale=1')
    |     
    title Recent ones
    // Bootstrap
    link(href='/bootstrap/css/bootstrap.min.css', rel='stylesheet')
    // HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries
    // WARNING: Respond.js doesn't work if you view the page via file://
    //if lt IE 9
      script(src='https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js')
      |       
      script(src='https://oss.maxcdn.com/respond/1.4.2/respond.min.js')     
    style.
      @font-face {
      font-family:roboto-thin;
      src:url('/bootstrap/fonts/Roboto-Thin.ttf');
      }
      @font-face {
      font-family:high;
      src: url('/bootstrap/fonts/Attentica.ttf');
      }
      @font-face {
      font-family:br;
      src: url('/bootstrap/fonts/bebasneue_regular.ttf');
      }
      @font-face {
      font-family:bt;
      src: url('/bootstrap/fonts/bebasneue_thin.ttf');
      }
      h1 {
      font-family:high;
      font-size:3vw;
      display:inline;
      color:white;
      }
      body {
      min-width:768px;
      background-color:#fff;
      background-image:url('/bootstrap/images/stripe4.png');
      filter: grayscale(50%);
      }
      h2 {
      font-size:6vw;
      font-family:br;
      letter-spacing:7px;
      }
      h3 {
      font-size:3vw;
      }
      h4 {
      font-size:1vw;
      font-family:arial;
      letter-spacing:0.3vw;
      text-transform:uppercase;
      color:white;
      }
      h5 {
      letter-spacing:2px;
      text-transform:uppercase;
      font-family:roboto-thin;
      color:white;
      font-size:3vw;
      }
      .preview {
      margin:0px;
      padding:0px;
      border-right:1px solid black;
      -webkit-filter: grayscale(100%);
      -moz-filter: grayscale(100%);
      -o-filter: grayscale(100%);
      -ms-filter: grayscale(100%);
      }
      .preview:hover {
      -webkit-filter: grayscale(0%);
      -moz-filter: grayscale(0%);
      -o-filter: grayscale(0%);
      -ms-filter: grayscale(0%);
      }
      img {
      width:100%;
      }
      .imgrow {
      border-bottom:1px solid black;
      }
      .placenamebckgrnd {
      position:absolute;
      color:white;
      opacity:0.7;
      width:100%;
      margin-bottom:auto;
      background-color:black;
      text-align:center;
      z-index:1;
      height:25%;
      }
      .placename {
      position:absolute;
      color:black;
      width:100%;
      text-align:center;
      margin-bottom:auto;
      z-index:2;
      }
      #footer {
      background-color:gray;
      letter-spacing:2px;
      text-transform:uppercase;
      text-align:center;
      }
      #header {
      padding-top:0.5vw;
      background-color:gray;
      }
      .spart{
      height:2vh;
      background-color:#333;
      }
      #timeperiod {
      background-color:#fff;
      }
      .color {
      height:10vh;
      }
      #blue{
      background-color:#001c45;
      }
      #green{
      background-color:#49a881;
      }
      #white{
      background-color:white;
      }
      .imgrow {
      background-color:#333;
      }
      .container-fluid {
      min-height:100vh;
      background-color:#eee;
      }
      #footer{
      width:100%;
      position:fixed;
      bottom:0px;
      }
      @media only screen
      and (min-device-width : 768px)
      and (max-device-width : 1024px)
      {
      .container-fluid {
      width:100vw;
      margin:0px;
      }
      #footer{
      background-color:;
      width:100%;
      position:fixed;
      bottom:0px;
      }
      }   
  body
    .container-fluid
      script(src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js')
      #header.row
        .col-xs-4
          h1(style='color:#ff9900') Moscow
        |         
        .col-xs-4(style='text-align:center;')
          a(href='http://recentones.com')
            h1 Recent ones         
      #timeperiod.row
        a(href='/')
          .col-xs-4(style='border-right:1px dotted #ddd;text-align:center;')
            h2(style='color:#ddd;') Лента
        .col-xs-4(style='border-right:1px dotted #ddd;text-align:center;')
            h2(style='color:gray;') Рейтинги:
        |           
        a(href='/search')
          .col-xs-4(style='text-align:center;')
            h2(style='color:#ddd;') Поиск       
      .row
        #inserts.col-xs-12(style='text-align:center; background-color:#eee;padding-top:4vw;')
      //       
        #footer.row
          a(href='/about')
            .col-xs-4(style='border-right:1px dotted #ddd;text-align:center;')
              h4 About
          |         
          a(href='/contacts')
            .col-xs-4(style='border-right:1px dotted #ddd;text-align:center;')
              h4 Contacts
          |         
          a(href='/policy')
            .col-xs-4
              h4 Policy
      script.
        var toplist = !{doc};
        console.log(toplist);
        toplist = JSON.parse(toplist);
        console.log(toplist);
        var left = toplist.length%3;
        var times = (toplist.length-left)/3;
        if(toplist.length<3){
         for (var xx=0;xx<toplist.length;xx++)
        {
          var rnum = xx+1;
          $('#inserts').append("<div class='row' id='row"+rnum+"'></div>");
          for (var i=0;i<toplist.length;i++){
            var cellnum = xx*3+i+1;
            var insert = "<div class='col-xs-4' id='ratcell"+cellnum+"'></div>";
            eval("$('#row"+rnum+"').append(insert);");
            for (var yy=0;yy<10;yy++){
           eval("$('#ratcell"+cellnum+"').append('<h4>"+toplist[xx].places[yy]+"</h4>')");
          }
          }
        }
        }
        else{
        for (var xx=0;xx<times;xx++)
        { 
          var rnum = xx+1;
          $('#inserts').append("<div class='row' id='row"+rnum+"'></div>");
          if(rnum===times && times>1 && left != 3 && left != 0){
          for (var yy=0;yy<left;yy++){
           var cellnum = xx*3+yy+1;
            var insert = "<div class='col-xs-4' id='ratcell"+cellnum+"'></div>";
            eval("$('#row"+rnum+"').append(insert);");
            for (var zz=0;zz<10;zz++){
           eval("$('#ratcell"+cellnum+"').append('<h4>"+toplist[xx].places[zz]+"</h4>')");
          }
          }
        }
          else{
          for (var i=0;i<3;i++){
            var cellnum = xx*3+i+1;
            var insert = "<div class='col-xs-4' id='ratcell"+cellnum+"'></div>";
            eval("$('#row"+rnum+"').append(insert);");
            for (var yy=0;yy<10;yy++){
           eval("$('#ratcell"+cellnum+"').append('<h4>"+toplist[xx].places[yy]+"</h4>')");
          }
          }
         }
         }   
         }   
